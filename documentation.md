<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [BufferQueue][1]
    -   [Parameters][2]
    -   [getPriority][3]
        -   [Parameters][4]
    -   [has][5]
        -   [Parameters][6]
    -   [add][7]
        -   [Parameters][8]
    -   [isEmpty][9]
    -   [size][10]
        -   [Parameters][11]
    -   [sizePerPriority][12]
    -   [remove][13]
        -   [Parameters][14]
    -   [reset][15]
    -   [abort][16]
        -   [Parameters][17]
    -   [abortAll][18]
    -   [getStatus][19]
    -   [sortWithinLevel][20]
-   [EventManager][21]
    -   [on][22]
        -   [Parameters][23]
    -   [emit][24]
        -   [Parameters][25]
-   [PriorityQueue][26]
    -   [Parameters][27]
    -   [getPriority][28]
        -   [Parameters][29]
    -   [has][30]
        -   [Parameters][31]
    -   [add][32]
        -   [Parameters][33]
    -   [pop_ORIG][34]
    -   [pop][35]
    -   [isEmpty][36]
    -   [size][37]
        -   [Parameters][38]
    -   [sizePerPriority][39]
    -   [remove][40]
        -   [Parameters][41]
    -   [reset][42]
    -   [getStatus][43]
    -   [sortWithinLevel][44]
-   [Queue][45]
    -   [add][46]
        -   [Parameters][47]
    -   [has][48]
        -   [Parameters][49]
    -   [pop][50]
    -   [isEmpty][51]
    -   [size][52]
        -   [Parameters][53]
    -   [first][54]
    -   [last][55]
    -   [remove][56]
        -   [Parameters][57]
    -   [reset][58]
    -   [sortByPriorityScore][59]

## BufferQueue

**Extends EventManager**

This is the main object of the BufferQueue library.

Emitted events:

-   'added': when a new element to download is added to the queue
-   'removed': when an element is removed (and will not be downloaded)
-   'reseted': when the whole queue is reseted
-   'downloading': when a file is starting to be downloading (after being popped from the queue)
-   'failed': when a file could not be downloaded properly (status above 2xx)
-   'aborted': when a file download is aborted by an explicit abort() call
-   'success': when a file has been successfully downloaded and converted into an ArrayBuffer. Callback arguments are URL, ArrayBuffer, downloadTimeMs

### Parameters

-   `options` **[Object][60]** the option object

### getPriority

Get the level of priority of a given file

#### Parameters

-   `str` **[string][61]** URL of the file to check

Returns **[number][62]** zero is the highest priority, -1 means the element is NOT
in the queue

### has

Checks if a string is in the queue. Optionally, we can verify a specific
level only.

#### Parameters

-   `str` **[string][61]** string to verify the presence in the queue
-   `priority` **[number][62]** OPTIONAL the priority (must be in [0, level-1]) (optional, default `-1`)

Returns **[boolean][63]** 

### add

Add a string to the queue with a given priority.
If the string is already present in the queue with the same level of priority or higher, then nothing is done.
If the string is already present but with a different level of priority, then
it is removed and added with the provided level or priority.

Emits the event 'added' with the str as argument if properly added.

#### Parameters

-   `str` **[string][61]** the string to add
-   `priority` **[number][62]** the priority (must be in [0, level-1])
-   `priorityScore`   (optional, default `Infinity`)
-   `true` **[boolean][63]** if added, false if not (because already in with a higher priority)

### isEmpty

Check if the priority queue is empty (= if all the per-level-queues are all empty)

Returns **[boolean][63]** true if empty, false if not empty

### size

Get the total number of elements in the priority queue, or optionnaly, for a specific
level of priority

#### Parameters

-   `priority` **[number][62]** OPTIONAL level of priority
-   `number` **[number][62]** of elements

### sizePerPriority

Get the size of the queue for each priority level

Returns **[array][64]** 

### remove

Note: this should be used as rarely as possible since it does not respect the logic
of a queue.
Remove an element. If null is returned, this means the element was not in the queue.

Emits the event 'removed' if the str as argument if properly removed

#### Parameters

-   `str`  
-   `null-null` **[string][61]** str, the element to remove

Returns **([string][61] | null)** the element that was jsut removed

### reset

Reset the whole priority queue, empty it all. No value returned.

Emits the event 'reseted' without any argument

### abort

Abort the download of a specific file. If the file was actually being downloaded,
the `aborted` event will be emitted.
Note: once a file is aborted, it is no longer in a queue.

#### Parameters

-   `str` **[string][61]** the URL of the file to abort

### abortAll

Abort all the current downloads. `aborted` event will be emitted.

### getStatus

Get a string status of the prioirty queue size per level and the number of
files currently being downloaded.

Returns **[string][61]** 

### sortWithinLevel

If priority scores are given, elements can be sorted based on that.

## EventManager

The EventManager deals with events, create them, call them.
This class is mostly for being inherited from.

### on

Define an event, with a name associated with a function

#### Parameters

-   `eventName` **[String][61]** Name to give to the event
-   `callback` **[Function][65]** function associated to the even

### emit

Emit the event(s). If multiple callbacks are tied to this event,
they will be called in the order they were declared.

#### Parameters

-   `eventName` **[string][61]** name of the event to fire.
-   `args` **[array][64]** argument to call the callback with.
    Note that within the callback, those arguments will be "flattened" and not as an array. (optional, default `[]`)

## PriorityQueue

This priority queue works with levels of priority, 0 beeing the highest priority
and following level will be of decreasing priority.
In term of implementation, PriorityQueue instanciates N Queues, where N is the
number of priority levels. The number of priority levels has to be given at
the creation of a PriorityQueue instance.

### Parameters

-   `levels`   (optional, default `3`)

### getPriority

Get the level of priority of a given string

#### Parameters

-   `str`  

Returns **[number][62]** zero is the highest priority, -1 means the element is NOT
in the queue

### has

Checks if a string is in the queue. Optionally, we can verify a specific
level only.

#### Parameters

-   `str` **[string][61]** string to verify the presence in the queue
-   `priority` **[number][62]** OPTIONAL the priority (must be in [0, level-1]) (optional, default `-1`)

Returns **[boolean][63]** 

### add

Add a string to the queue with a given priority.
If the string is already present in the queue with the same level of priority or higher, then nothing is done.
If the string is already present but with a different level of priority, then
it is removed and added with the provided level or priority.

#### Parameters

-   `str` **[string][61]** the string to add
-   `priority` **[number][62]** the priority (must be in [0, level-1])
-   `priorityScore`   (optional, default `Infinity`)
-   `true` **[boolean][63]** if added, false if not (because already in with a higher priority)

### pop_ORIG

Get the the element with the highest priority and remove it from the queue

Returns **([string][61] | null)** can return null if the queue is empty

### pop

This version of pop relies on the probability map to make sure that some lower
priorities items are getting popped every now and then, even if there are still
elements in higher priority queues

### isEmpty

Check if the priority queue is empty (= if all the per-level-queues are all empty)

Returns **[boolean][63]** true if empty, false if not empty

### size

Get the total number of elements in the priority queue, or optionnaly, for a specific
level of priority

#### Parameters

-   `priority` **[number][62]** OPTIONAL level of priority (optional, default `-1`)
-   `number` **[number][62]** of elements

### sizePerPriority

Get the size of the queue for each priority level

Returns **[array][64]** 

### remove

Note: this should be used as rarely as possible since it does not respect the logic
of a queue.
Remove an element. If null is returned, this means the element was not in the queue.

#### Parameters

-   `str`  
-   `null-null` **[string][61]** str, the element to remove

Returns **([string][61] | null)** the element that was jsut removed

### reset

Reset the whole priority queue, empty it all. No value returned.

### getStatus

Get a string status about the queue length per level

Returns **[string][61]** 

### sortWithinLevel

If a priotrity score is given to the elements, then each level of priority can
have their element sorted within.

## Queue

A queue to add and pop string. It also provides an arbitrary remove function.
A queue is first-in-first-out.
Elements in this queue must be strings

### add

Add a string at the end of the queue. Not added again if already in there.

#### Parameters

-   `str` **[string][61]** some string to add
-   `priorityScore`   (optional, default `Infinity`)

### has

Check if this queue contains a given string

#### Parameters

-   `str`  

Returns **[boolean][63]** true if this queue has a given string, false if not

### pop

Extract the first element

Returns **[string][61]** the first element

### isEmpty

Is the queue empty?

Returns **[boolean][63]** true if empty, false if not

### size

Get the number of element in the queue

#### Parameters

-   `number`  

### first

Get the first element of the queue without removing it
(Not sure how useful is that)

Returns **[string][61]** 

### last

Get the last element of the queue without removing it
(Not sure how useful is that)

Returns **[string][61]** 

### remove

Remove an element from the queue and returns it

#### Parameters

-   `str` **[string][61]** an element to remove

Returns **([string][61] | null)** 

### reset

Remove all the elements of the queue

### sortByPriorityScore

If a priority score is given to the elements, then we can sort the queue based on that

[1]: #bufferqueue

[2]: #parameters

[3]: #getpriority

[4]: #parameters-1

[5]: #has

[6]: #parameters-2

[7]: #add

[8]: #parameters-3

[9]: #isempty

[10]: #size

[11]: #parameters-4

[12]: #sizeperpriority

[13]: #remove

[14]: #parameters-5

[15]: #reset

[16]: #abort

[17]: #parameters-6

[18]: #abortall

[19]: #getstatus

[20]: #sortwithinlevel

[21]: #eventmanager

[22]: #on

[23]: #parameters-7

[24]: #emit

[25]: #parameters-8

[26]: #priorityqueue

[27]: #parameters-9

[28]: #getpriority-1

[29]: #parameters-10

[30]: #has-1

[31]: #parameters-11

[32]: #add-1

[33]: #parameters-12

[34]: #pop_orig

[35]: #pop

[36]: #isempty-1

[37]: #size-1

[38]: #parameters-13

[39]: #sizeperpriority-1

[40]: #remove-1

[41]: #parameters-14

[42]: #reset-1

[43]: #getstatus-1

[44]: #sortwithinlevel-1

[45]: #queue

[46]: #add-2

[47]: #parameters-15

[48]: #has-2

[49]: #parameters-16

[50]: #pop-1

[51]: #isempty-2

[52]: #size-2

[53]: #parameters-17

[54]: #first

[55]: #last

[56]: #remove-2

[57]: #parameters-18

[58]: #reset-2

[59]: #sortbypriorityscore

[60]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[61]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[62]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[63]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[64]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[65]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function
